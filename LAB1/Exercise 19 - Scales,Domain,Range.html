<html>

  <head>
    <script src='https://d3js.org/d3.v7.min.js'></script>
  </head>


  <body>



    <script>
      /*Exercise 19: Put the code in a ‘function’ so the bar chart is only displayed when the function is called.  Also if the 
function is called twice, then it will show the bar chart twice on screen.  Extend this function so it takes a ‘csv’ file 
name as the input argument.  Call it twice and it displays two different bar charts using different data on screen.   */


      let dataM = 'https://raw.githubusercontent.com/Hookay/DataVisualization/main/LAB1/CSV/nu.csv'
      let dataN = 'https://raw.githubusercontent.com/Hookay/DataVisualization/main/LAB1/CSV/num2.csv'

      //const data = [50, 400, 300, 900, 250, 1000]
      const u = []
      const t=[]
      
      //call it first time
      d3.csv(dataM, function(data, i) {

        //make data numerical
        data.nu = +data.nu

        //push it into an array
        u.push(data.nu)

      }).then(function(data) {

          doSomething(u)
          doSomething(u)

      });

      //call it second time with different dataset
      d3.csv(dataN, function(data, i) {

        //make data numerical
        data.num = +data.num

        //push it into an array
        t.push(data.num)

      }).then(function(data) {


        doSomething(t)

      });



      function doSomething(data) {


        const width = 500;
        const barHeight = 20;
        const margin = 1;

        //console.log(data)

        var scale = d3.scaleLinear()
          .domain([d3.min(data), d3.max(data)])
          .range([50, 500]);

        var svg = d3.select("body")
          .append("svg")
          .attr("width", width)
          .attr("height", barHeight * data.length);

        var g = svg.selectAll("g")
          .data(data)
          .enter()
          .append("g")
          .attr("transform", function(d, i) {
            return "translate(0," + i * barHeight + ")";
          });

        g.append("rect")
          .attr("width", function(d) {
            return scale(d);
          })
          .attr('fill', function(d, i) {
            if (d < 100) {
              return 'green';
            }
            if (d > 500) {
              return 'red';
            } else {
              return 'blue';
            }
          })
          .attr("height", barHeight - margin)

        g.append("text")
          .attr("x", function(d) {
            return (scale(d));
          })
          .attr("y", barHeight / 2)
          .attr("dy", ".35em")
          .style('text-anchor', 'end')
          .style("fill", "white")
          .text(function(d) {
            return d;
          });


      };

    </script>
  </body>

</html>
